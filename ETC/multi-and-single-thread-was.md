싱글스레드인데 어떻게 더 많은트래픽을 감당할수있는 것일까

process vs thread
쓰레드는 하나의 프로세스안에서 메모리 자원들을 공유

잘못구현하면? (thread safe 하게 구현하지않으면) 문제발생 -> 여러 쓰레드가 자원을 공유하기 때문에 당연히 발생 가능한 문제
ex) 크롬은? 하나의 탭이 다른 탭에 영향을 미치지 않기 위해서 별도 프로세스로 뜨는 것을 알 수 있다

멀티스레드로 잘살고 있던 어느날
1만명 동시접속하려면 어떻게해야할까?
톰캣의 기본 맥스 스레드는 200밖에 되지 않는다

위 문제를 멀티스레드로 구현시 가장 문제점은 컽텍스트 스위칭 비용이크다는 점이다
데이터를 어딘가에 저장을해야 프로세스가 자원을 지속적으로 공유가능해진다

싱글스레드, 논블락킹, 어싱크 구조를 통해서 구현가능하지 않을까?

멀티도힘든데 싱글로?
어싱크, 논블럭킹 같은말아니야?

주문예시
주문 0.5초
주문완료 후 메일전송 2초

싱크기반일때
0.5+2=2.5초

메일발송을 async로 처리할경우 0.5초 +알파

스프링에서는 어싱크 애노테이션만 사용하면 된다
익시큐터에서맥스 풀사이즈를 설정해 주면 된다

싱크/어싱크
블록킹/논블록킹
io 처리 관점에서 등장하는 개념

소켓io 기술 발전과정
프로세스 vs 소켓 - 1대1
스레드 vs 소켓 1대1

너무비효율 적이기 때문에 io멀티플렉싱기법이 도입됏다
하나의 스레드가 여러 사용자들을 처리할 수있어 효율적

select멀티플렉싱 맥스 1024
운영체제별로 api가 다 있음

블락킹은 함수호출햇는데 바로응답 하냐 마냐

웹에서의 폴링과 푸시를 통해 싱크어싱크 블락킹논블락킹을 예시를 들 수 있다

윈도우즈 iocp 어싱크 논블럭

어싱크 블럭킹 - 이런 사례는 거의 없으므로 무시, 굳이 알려고할필요 없음

nodejs는 싱글스레드

이벤트 큐,쓰리드풀 (이벤트뤂이 계속 동작)

자바진영에도미슷한모델이 webflux가있다.

노드js는 이벤트루프가싱글스레드이지만 webflux는 멀티스레드이다

webflux가 가장 적합한 모델은  gateway역할을 하는 백엔드api를 중앙집중화하는 프론트 api서버
r2dbc가 활발히 개발된다면 reative개발이 활성화될수 있다

Webflux는 CPU 코어갯수에 따라서 스레드 갯수가 결정된다